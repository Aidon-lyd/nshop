<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>ECharts</title>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="echarts/echarts.min.js"></script>
</head>

<body>
    <div id="main" style="width: 100%;height:600px;"></div>s
    <script type="text/javascript">
        $(document).ready(function () {
            // 基于准备好的dom，初始化echarts实例
            var myChart = echarts.init(document.getElementById('main'));
            // 指定图表的配置项和数据
            var data1 = genData(50);
            //数据加载完之前先显示一段简单的loading动画
            myChart.showLoading();
            $.ajax({
                type: "post",
                async: true,            //异步请求（同步请求将会锁住浏览器，用户其他操作必须等待请求完成才可以执行）
                url: "http://localhost:8080/nshop/SearchAndCount",    //请求发送到dataActiont处
                data: {},
                dataType: "json",        //返回数据形式为json
                success: function (result) {
                    //请求成功时执行该函数内容，result即为服务器返回的json对象
                    if (result) {
                        data1 = result;
                        data: { };

                        for (i = 0; i < data1.length; i++) {
                            legendData.push(data1[i].name);//挨个取出类别并填入类别数
                            //seriesData.push();//挨个取出销量并填入销量数组
                            seriesData.push({
                                name: data1[i].name,
                                value: data1[i].value
                            });
                            selected.push(data1[i].name) = i < 6;
                        }
                        myChart.hideLoading();    //隐藏加载动画
                        myChart.setOption(
                            {
                                title: {
                                    text: '平台搜索热词数量统计',
                                    subtext: '用户搜索的就是20605等',
                                    x: 'center'
                                },
                                tooltip: {
                                    trigger: 'item',
                                    formatter: "{a} <br/>{b} : {c} ({d}%)"
                                },
                                legend: {
                                    type: 'scroll',
                                    orient: 'vertical',
                                    right: 10,
                                    top: 20,
                                    bottom: 20,
                                    data: legendData,
                                    selected: selected
                                },
                                series: [
                                    {
                                        name: '搜索分类',
                                        type: 'pie',
                                        radius: '55%',
                                        center: ['40%', '50%'],
                                        data: seriesData,
                                        itemStyle: {
                                            emphasis: {
                                                shadowBlur: 10,
                                                shadowOffsetX: 0,
                                                shadowColor: 'rgba(0, 0, 0, 0.5)'
                                            }
                                        }
                                    }
                                ]
                            }
                        );
                    }
                },
                error: function (errorMsg) {
                    //请求失败时执行该函数
                    alert("图表请求数据失败!");
                    myChart.hideLoading();
                }
            });//end ajax

        });
    </script>
</body>

</html>